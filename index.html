
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>è»½è²¨ç‰©ãƒ‰ãƒ©ã‚¤ãƒãƒ¼åæ”¯ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
  <style>
    body { font-family: sans-serif; padding: 1.5rem; background: #f4f4f4; }
    h1 { color: #2c3e50; font-size: 1.5rem; margin-bottom: 1rem; }
    label { display: block; margin: 0.8rem 0 0.3rem; }
    input[type="number"], input[type="date"] {
      padding: 0.5rem; width: 100%; max-width: 250px; font-size: 1rem;
    }
    button { margin-top: 1rem; padding: 0.6rem 1.2rem; font-size: 1rem; }
    table { width: 100%; margin-top: 2rem; border-collapse: collapse; }
    th, td { padding: 0.5rem; border: 1px solid #ccc; text-align: center; }
    .chart-container { margin-top: 2rem; }
  </style>
</head>
<body>
  <h1>ğŸ“¦ è»½è²¨ç‰©ãƒ‰ãƒ©ã‚¤ãƒãƒ¼åæ”¯ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>

  <label>æ—¥ä»˜: <input type="date" id="date" /></label>
  <label>é…é”ä»¶æ•°: <input type="number" id="deliveries" value="100" /></label>
  <label>å˜ä¾¡ï¼ˆå††ï¼‰: <input type="number" id="unitPrice" value="160" /></label>
  <label>ãƒ­ã‚¤ãƒ¤ãƒªãƒ†ã‚£ï¼ˆï¼…ï¼‰: <input type="number" id="royalty" value="10" /></label>
  <label>ã‚¬ã‚½ãƒªãƒ³ä»£ï¼ˆå††ï¼‰: <input type="number" id="fuelCost" value="0" /></label>
  <label>ãã®ä»–çµŒè²»ï¼ˆå††ï¼‰: <input type="number" id="otherCost" value="0" /></label>
  <button onclick="saveRecord()">ğŸ’¾ è¨˜éŒ²ã‚’ä¿å­˜</button>

  <div class="result" id="resultArea"></div>
  <table id="recordTable">
    <thead>
      <tr><th>æ—¥ä»˜</th><th>ä»¶æ•°</th><th>å£²ä¸Š</th><th>åæ”¯</th><th>æ“ä½œ</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const storageKey = "deliveryRecords";

    function saveRecord() {
      const date = document.getElementById("date").value;
      const deliveries = parseInt(document.getElementById("deliveries").value) || 0;
      const unitPrice = parseFloat(document.getElementById("unitPrice").value) || 0;
      const royalty = parseFloat(document.getElementById("royalty").value) || 0;
      const fuel = parseFloat(document.getElementById("fuelCost").value) || 0;
      const other = parseFloat(document.getElementById("otherCost").value) || 0;

      if (!date) return alert("æ—¥ä»˜ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");

      const gross = deliveries * unitPrice;
      const royaltyAmount = gross * (royalty / 100);
      const net = gross - royaltyAmount - fuel - other;

      const record = { date, deliveries, gross, net };
      const records = JSON.parse(localStorage.getItem(storageKey) || "[]");

      const existingIndex = records.findIndex(r => r.date === date);
      if (existingIndex !== -1) records.splice(existingIndex, 1);

      records.push(record);
      localStorage.setItem(storageKey, JSON.stringify(records));
      renderTable();
    }

    function renderTable() {
      const records = JSON.parse(localStorage.getItem(storageKey) || "[]").sort((a,b)=>a.date.localeCompare(b.date));
      const tbody = document.querySelector("#recordTable tbody");
      tbody.innerHTML = "";

      for (const record of records) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${record.date}</td>
          <td>${record.deliveries}</td>
          <td>${record.gross.toLocaleString()}</td>
          <td>${record.net.toLocaleString()}</td>
          <td><button onclick="deleteRecord('${record.date}')">ğŸ—‘ï¸</button></td>
        `;
        tbody.appendChild(tr);
      }
    }

    function deleteRecord(date) {
      let records = JSON.parse(localStorage.getItem(storageKey) || "[]");
      records = records.filter(r => r.date !== date);
      localStorage.setItem(storageKey, JSON.stringify(records));
      renderTable();
    }

    renderTable();
  </script>
</body>
</html>
